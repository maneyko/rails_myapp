# This file should be linked to /etc/nginx/site-available/rails_myapp.conf
# Afer that, to enable this app, do:
#     sudo ln -s /etc/nginx/sites-available/rails_myapp.conf /etc/nginx/sites-enabled/
#
# NOTE: This block should be in the main server block so that the main server
# may still run PHP for all other routes.
# location ~ ^/rails/?(.*)$ {
#     proxy_pass_request_headers on;
#     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#     proxy_set_header Host $http_host;
#     proxy_pass http://rails_myapp/$1;
# }

upstream rails_myapp {
    server unix:/var/www/rails_myapp/tmp/sockets/unicorn.sock fail_timeout=0;
}

server {
    location / {
        proxy_pass_request_headers on;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $http_host;
        proxy_pass http://rails_myapp;
    }
}

# vim: ft=nginx
